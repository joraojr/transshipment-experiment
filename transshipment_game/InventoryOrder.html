{% extends "global/Page.html" %}

{% block title %}
    Task 2: Inventory Order
    <p class="mt-3" style="font-size: large"> ROUND {{ CURRENT_ROUND }}/{{ C.NUM_ROUNDS }}</p>

{% endblock %}
{% block content %}

    <script src="https://code.highcharts.com/highcharts.js"></script>
    {#    <script src="https://code.highcharts.com/modules/exporting.js"></script>#}
    {#    <script src="https://code.highcharts.com/modules/export-data.js"></script>#}
    {#    <script src="https://code.highcharts.com/modules/accessibility.js"></script>#}

    <div class="container-fluid">
        <div id="white_infobox" class=" col-md-7 border rounded border-3 mx-auto">
            <div class="row">
                <div class="col-md-12" style="text-align: center">
                    <h4>Place an inventory order to meet customer demand.</h4>
                    {% if player.group.transfer_engagement %}
                        <b>OBS:</b> You and the other retailer <b>decided to engage</b> in a transfer.
                    {% else %}
                        <b>OBS:</b> You and the other retailer <b>decided to not engage</b> in a transfer.
                    {% endif %}
                </div>
            </div>
            <div class="col-md-2"></div>

            <div class="row justify-content-center">
                <div class="col-md-3 text-end">
                    <b>Your Order: </b>
                </div>
                <div class="col-md-2">
                    {% form.inventory_order %}
                </div>
                <div class="col-md-1">
                    <button class="otree-btn-next btn btn-primary">Send</button>
                </div>
                <div class="col-md-2"></div>
            </div>
        </div>

        <div class="row">
            <div id="white_infobox" class="col-md-6 border border-3 rounded">
                <figure class="highcharts-figure">
                    <div id="container"></div>
                </figure>
            </div>
            <div class="col-md-6">

                <div class="row">
                    <table>
                        <tr>
                            <th class="col-2">Revenue</th>
                            <th>Description: The amount you receive ...</th>
                            <th>ECU</th>
                        </tr>
                        <tr>
                            <td>Retail</td>
                            <td>... for each unit sold to consumers</td>
                            <td>40</td>
                        </tr>
                        <tr>
                            <td>Transfer</td>
                            <td>... from the other retailer for each unit transferred</td>
                            <td>12</td>
                        </tr>
                        <tr>
                            <td>Salvage</td>
                            <td>... for each unit that you do not sell or transfer</td>
                            <td>10</td>
                        </tr>
                    </table>
                </div>
                <div class="row">
                    <table>
                        <tr>
                            <th class="col-2">Costs</th>
                            <th>Description: The amount you pay ...</th>
                            <th>ECU</th>
                        </tr>
                        <tr>
                            <td>Procurement</td>
                            <td>... per unit originally ordered</td>
                            <td>20</td>
                        </tr>
                        <tr>
                            <td>Transfer</td>
                            <td>... to the other retailer for each unit transferred to you</td>
                            <td>12</td>
                        </tr>
                    </table>
                </div>

            </div>
        </div>
    </div>


    <style>

        #white_infobox,
        #white_infobox div {
            background-color: white;
            padding: 12px;
        }

        .otree-body {
            max-width: 1600px;
        }

        .otree-title {
            text-align: center;
        }

        #container {
            height: 400px;
            background-color: white;

        {#width: fit-content;#}
        }

        {#.highcharts-figure,#}
        {#.highcharts-data-table table {#}
        {#    min-width: 310px;#}
        {#    max-width: 800px;#}
        {#    margin: 1em auto;#}
        {# }#}


        {#.highcharts-data-table table {#}
        {#    font-family: Verdana, sans-serif;#}
        {#    border-collapse: collapse;#}
        {#    border: 1px solid #ebebeb;#}
        {#    margin: 10px auto;#}
        {#    text-align: center;#}
        {#    width: 100%;#}
        {#    max-width: 500px;#}
        {# }#}
        {##}
        {#.highcharts-data-table caption {#}
        {#    padding: 1em 0;#}
        {#    font-size: 1.2em;#}
        {#    color: #555;#}
        {# }#}
        {##}
        {#.highcharts-data-table th {#}
        {#    font-weight: 600;#}
        {#    padding: 0.5em;#}
        {# }#}
        {##}
        {#.highcharts-data-table td,#}
        {#.highcharts-data-table th,#}
        {#.highcharts-data-table caption {#}
        {#    padding: 0.5em;#}
        {# }#}
        {##}
        {#.highcharts-data-table thead tr,#}
        {#.highcharts-data-table tr:nth-child(even) {#}
        {#    background: #f8f8f8;#}
        {# }#}
        {##}
        {#.highcharts-data-table tr:hover {#}
        {#    background: #f1f7ff;#}
        {# }#}

        table {
            border-collapse: collapse;
            margin-top: 20px;
        }

        th, td {
            border: 1px solid #000;
            padding: 8px;
            text-align: left;
            background-color: #FFFFFF;

        }

        th {
            background-color: #f2f2f2;
        }

    </style>

    <script type="text/javascript">

        Highcharts.chart('container', {
            credits: {
                enabled: false
            },
            chart: {
                type: 'column',
            },
            title: {
                text: 'Your order/demand history',
                align: 'left'
            },

            xAxis: {
                title: {
                    text: 'Rounds'
                },
                categories: Array.from({length: {{C.NUM_ROUNDS}}}, (v, k) => k + 1),
                {#min: 1,#}
                {#max: {{C.NUM_ROUNDS}},#}
                {#tickInterval: 1,#}
                crosshair: true

            },
            yAxis: {
                min: 0,
                max: 200,
                title: {
                    text: 'ECU'
                },
            },
            plotOptions: {
                column: {
                    pointPadding: 0.2,
                    borderWidth: 0
                }
            },
            tooltip: {
                valueSuffix: 'ECU'
            },
            series: [
                {
                    name: 'Order',
                    data: {{player_inventory_order_history}}
                },
                {
                    name: 'Demand',
                    data: {{player_demand_history}}
                }
            ]

        });


    </script>

{% endblock %}
